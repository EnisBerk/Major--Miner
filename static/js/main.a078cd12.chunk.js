(this.webpackJsonpmajor_miner=this.webpackJsonpmajor_miner||[]).push([[0],{206:function(e,t,a){e.exports=a.p+"static/media/MajorMinerHeaderLogo.0cebf6b2.png"},275:function(e,t,a){e.exports=a(507)},280:function(e,t,a){},347:function(e,t,a){},507:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(32),c=a.n(o),i=a(13),s=a(14),l=a(16),u=a(15),d=a(17),m=a(217),p=(a(280),a(510)),h=a(512),y=a(511),g=a(52),f=a.n(g),b=(a(341),a(342),f.a.initializeApp({apiKey:"AIzaSyC8XcgJO6P2vYnN5akex9EWn4ZSg4-osVM",authDomain:"majorminer-d149c.firebaseapp.com",databaseURL:"https://majorminer-d149c.firebaseio.com",projectId:"majorminer-d149c",storageBucket:"majorminer-d149c.appspot.com",messagingSenderId:"44081100020"})),v=a(45),E=a(2),w=a(7),k=a.n(w),x=a(37),j=a(18),O=a(509),S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).Summary=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u,d,m,p,h,y,g,f,v,E,w,j,O,S,C,I,N,T,P,M,A,R,D,H,U,q,F,B,L,W,_,z,K,Y,V,G,J,$,Z,Q,X,ee,te,ae;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.user=b.auth().currentUser,a.db=b.firestore(),a.currentId=a.user.uid,a.userId=a.user.uid,a.userRef=a.db.collection("users").doc(a.currentId),a.audioRef=a.db.collection("audios"),t=[],n=[],e.next=10,a.userRef.collection("clipHistory").orderBy("lastUpdatedAt").limit(10).get();case 10:r=e.sent,o={},c=!0,i=!1,s=void 0,e.prev=15,l=r.docs[Symbol.iterator]();case 17:if(c=(u=l.next()).done){e.next=61;break}return d=u.value,o[d.id]={score:d.data().score},m=a.db.collection("audios").doc(d.id).get(),t=[],n=[],p=a.db.collection("audios").doc(d.id).collection("users").doc(a.userId).get(),h=a.db.collection("audios").doc(d.id).collection("tags").get(),e.next=27,Promise.all([m,p,h]);case 27:for(y=e.sent,g=Object(x.a)(y,3),f=g[0],v=g[1],E=g[2],o[d.id].title=f.data().Title,o[d.id].url=f.data().Url,o[d.id].id=d.id,t=v.data().tags,o[d.id].TAG=t.join(", "),w=!0,j=!1,O=void 0,e.prev=40,S=E.docs[Symbol.iterator]();!(w=(C=S.next()).done);w=!0)I=C.value,t.includes(I.id)||n.push(I.id);e.next=48;break;case 44:e.prev=44,e.t0=e.catch(40),j=!0,O=e.t0;case 48:e.prev=48,e.prev=49,w||null==S.return||S.return();case 51:if(e.prev=51,!j){e.next=54;break}throw O;case 54:return e.finish(51);case 55:return e.finish(48);case 56:o[d.id].other=n.join(", "),a.setState({clipHistory:o});case 58:c=!0,e.next=17;break;case 61:e.next=67;break;case 63:e.prev=63,e.t1=e.catch(15),i=!0,s=e.t1;case 67:e.prev=67,e.prev=68,c||null==l.return||l.return();case 70:if(e.prev=70,!i){e.next=73;break}throw s;case 73:return e.finish(70);case 74:return e.finish(67);case 75:return e.next=77,a.userRef.collection("clipHistory").where("score",">",0).orderBy("score").limit(10).get();case 77:N=e.sent,T={},P=!0,M=!1,A=void 0,e.prev=82,R=N.docs[Symbol.iterator]();case 84:if(P=(D=R.next()).done){e.next=146;break}return H=D.value,T[H.id]={score:H.data().score},U=a.db.collection("audios").doc(H.id).get(),q=a.db.collection("audios").doc(H.id).collection("tags").where("userId","array-contains",a.userId).get(),F=a.db.collection("audios").doc(H.id).collection("tags").get(),e.next=92,Promise.all([U,q,F]);case 92:for(B=e.sent,L=Object(x.a)(B,3),W=L[0],_=L[1],z=L[2],T[H.id].title=W.data().Title,T[H.id].url=W.data().Url,T[H.id].id=H.id,t=[],n=[],K=!0,Y=!1,V=void 0,e.prev=105,G=_.docs[Symbol.iterator]();!(K=(J=G.next()).done);K=!0)$=J.value,t.push($.id);e.next=113;break;case 109:e.prev=109,e.t2=e.catch(105),Y=!0,V=e.t2;case 113:e.prev=113,e.prev=114,K||null==G.return||G.return();case 116:if(e.prev=116,!Y){e.next=119;break}throw V;case 119:return e.finish(116);case 120:return e.finish(113);case 121:for(T[H.id].TAG=t.join(", "),Z=!0,Q=!1,X=void 0,e.prev=125,ee=z.docs[Symbol.iterator]();!(Z=(te=ee.next()).done);Z=!0)ae=te.value,t.includes(ae.id)||n.push(ae.id);e.next=133;break;case 129:e.prev=129,e.t3=e.catch(125),Q=!0,X=e.t3;case 133:e.prev=133,e.prev=134,Z||null==ee.return||ee.return();case 136:if(e.prev=136,!Q){e.next=139;break}throw X;case 139:return e.finish(136);case 140:return e.finish(133);case 141:T[H.id].other=n.join(", "),a.setState({scoredClipHistory:T});case 143:P=!0,e.next=84;break;case 146:e.next=152;break;case 148:e.prev=148,e.t4=e.catch(82),M=!0,A=e.t4;case 152:e.prev=152,e.prev=153,P||null==R.return||R.return();case 155:if(e.prev=155,!M){e.next=158;break}throw A;case 158:return e.finish(155);case 159:return e.finish(152);case 160:console.log(a.state.scoredClipHistory),console.log(a.state.clipHistory),a.props.history.push({pathname:"/main/clip",state:{clipHistory:a.state.clipHistory,scoredClipHistory:a.state.scoredClipHistory}});case 163:case"end":return e.stop()}}),e,null,[[15,63,67,75],[40,44,48,56],[49,,51,55],[68,,70,74],[82,148,152,160],[105,109,113,121],[114,,116,120],[125,129,133,141],[134,,136,140],[153,,155,159]])}))),a.state={clipHistory:{},scoredClipHistory:{}},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home-page"},r.a.createElement("div",{className:"homelogo-page"}),r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy"},"Privacy Policy")))}}]),t}(n.Component);a(347);var C=function(e){return r.a.createElement("svg",{className:e.className,height:e.height,width:e.width,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},r.a.createElement("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z",fill:e.fill}))};var I=function(e){var t=Object(n.useState)(""),a=Object(x.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)("0px"),s=Object(x.a)(i,2),l=s[0],u=s[1],d=Object(n.useState)("accordion__icon"),m=Object(x.a)(d,2),p=m[0],h=m[1],y=Object(n.useRef)(null);return r.a.createElement("div",{className:"accordion__section"},r.a.createElement("button",{className:"accordion ".concat(o),onClick:function(){c(""===o?"active":""),u("active"===o?"0px":"".concat(y.current.scrollHeight,"px")),h("active"===o?"accordion__icon":"accordion__icon rotate")}},r.a.createElement("p",{className:"accordion__title"},e.title),r.a.createElement(C,{className:"".concat(p),width:10,fill:"#777"})),r.a.createElement("div",{ref:y,style:{maxHeight:"".concat(l)},className:"accordion__content"},r.a.createElement("div",{className:"accordion__text",dangerouslySetInnerHTML:{__html:e.content}})))},N=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"faq-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy"},"Privacy Policy")),r.a.createElement("h1",{className:"page-title"},"Frequently Asked Questions"),r.a.createElement("div",null,r.a.createElement(I,{title:"How should I describe the clips?",content:"There are many ways you could describe a clip, we want you to make up your own, but if you're stuck, here are some examples. You could use the names of the things you hear (as specifically or generally as you like), general descriptions of the scene, the time of day or year you think it is, even how it makes you feel. Here are some examples, by no means exhaustive, of each of those categories: <br></br> <li>    Animals \u2013 bird, songbird, sparrow, white-crowned sparrow, gambel's white crowned sparrow </li> <li> Human-generated sounds \u2013 airplane, helicopter, drilling, engine, rumbling </li> <li> Weather \u2013 wind, rain, thunder, gale, drizzle, dripping, stream, river </li> <li> Time \u2013 summer, winter, june, august afternoon, night, dawn </li> <li> Feelings \u2013 calm, busy, soothing, loud, cacophonous </li> <li> Scenes \u2013 quiet night, dawn chorus </li> "}),r.a.createElement(I,{title:"Can I input more than one tag at a time?",content:"Yes, separate your tags with commas."}),r.a.createElement(I,{title:"What's a good strategy to use?",content:"If you want to earn some points quickly, you can try to guess the obvious labels for a clip. Someone else has probably already used them, so you might get 1 point or you might get 0 points, depending on how many people have used them already. If you're feeling more patient, you can tag a clip with a slightly less obvious, more creative, or more subjective label, so you'll have a better chance of being the first person to use that tag. You won't get any points initially, but when someone else comes along and uses it too, you'll get 2 points. You'd be surprised how frequently other people are thinking the same thing as you. Just remember that every time one user scores a single point, another user has just scored two."}),r.a.createElement(I,{title:"Does it matter how I capitalize, punctuate, or spell words?",content:"Not much. Our matching algorithm is clever enough to handle these and give you credit for matching other players' tags that differ in capitalization, punctuation, and spelling."}),r.a.createElement(I,{title:"I found a clip that won't play, what should I do?",content:"If you press the play button and it jumps right back to play mode without playing anything, you've probably found a broken clip. If you could tag it won't play, we'll remove it from the game as quickly as we can."}),r.a.createElement(I,{title:"Why can't I use the browser's back button to go to the previous clip?",content:"That's intentional. Once you've gone to the summary page, you can go back and listen to your last clip (which you can do that from the summary page anyway), but you can't tag it anymore. Any tags you try to submit will be ignored. Only go to the summary page once you're finished tagging your current clip. This is to prevent people from looking at the artist name or other metadata when they're tagging a clip."})),"\xa0 \xa0")}}]),t}(n.Component),T=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"about-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy"},"Privacy Policy")),r.a.createElement("h1",{className:"page-title"},"About"),r.a.createElement("div",{className:"about-accordion"},r.a.createElement(I,{title:"What is MajorMiner?",content:"MajorMiner is a sound labeling game in which you will be presented with one randomly selected 10-second sound clip at a time. You will then describe that clip with a word or phrase (we call them tags) and press enter. If you're the first person to describe that clip with that tag, you'll get 2 points when the next person tags that clip with that tag. If you're the second person to describe that clip with that tag, you'll get 1 point immediately. If more than two people have already tagged that clip with that tag, you won't get any points, but you can always try another tag. You can tag each clip as many times as you want. When you are done with that clip, press the new clip button to listen to a new one."}),r.a.createElement(I,{title:"Why is it important?",content:"The goal of the game, besides just listening to interesting soundscapes, is to label them with original, yet relevant words and phrases that other players agree with."}),r.a.createElement(I,{title:"How will playing help the project?",content:"We're going to use your descriptions to teach our computers to recognize these same sounds in over 100,000 hours of recordings so that we can better understand the behavior of animals and how it is affected by human activity."})))}}]),t}(n.Component),P=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"contactus-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy"},"Privacy Policy")),r.a.createElement("h1",{className:"page-title"},"Contact Us"),r.a.createElement("div",{className:"contactus-contentbox"},r.a.createElement("div",{className:"textbox-content"},r.a.createElement("p",null,"Please contact us with any questions, comments, congratulations, or concerns! ",r.a.createElement("br",null),r.a.createElement("br",null)," The easiest way is to leave a comment on our blog: ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("a",{href:"blog.majorminer.org",style:{color:"black","text-decoration":"underline"}},"blog.majorminer.org"),r.a.createElement("br",null),r.a.createElement("br",null),"Or you can also send us an email: ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("a",{href:"mailto: info@majorminer.org",style:{color:"black","text-decoration":"underline"}},"info@majorminer.org")))))}}]),t}(n.Component),M=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"privacy-page"},r.a.createElement("h1",{className:"page-title"},"Privacy & Participation"),r.a.createElement("div",{className:"privacy-contentbox"},r.a.createElement("div",{className:"textbox-content"},r.a.createElement("p",null,"You are being asked to participate in this research study because you are an adult at least 18 years of age. The purpose of this research study is to collect descriptions of sounds from people, so that we can train computer models to automatically describe new sounds. If you agree to participate, we will ask you to listen to sounds and provide free-form textual descriptions of them. Listening to and labeling each sound will take less than a minute, and you can do as many or as few as you would like, whenever you would like. Research-related risks to you are minimal, but include fatigue and exposure to volume variations between sounds. We will only record your descriptions, we will not record any personally identifiable information from you and will only identify you within our system by a username of your choosing. The descriptions that we collect will be stored on our servers at Brooklyn College and made available to other researchers for the same purpose. Your participation in this research is voluntary. If you have any questions, you can contact Michael Mandel at: ",r.a.createElement("a",{href:"mailto: mim@sci.brooklyn.cuny.edu",style:{color:"black","text-decoration":"underline"}},"mim@sci.brooklyn.cuny.edu")," or 718.951.5000 x2053. If you have any questions about your rights as a research participant or if you would like to talk to someone other than the researchers, you can contact CUNY Research Compliance Administrator at: ",r.a.createElement("a",{href:"mailto: HRPP@cuny.edu",style:{color:"black","text-decoration":"underline"}},"HRPP@cuny.edu")," or 646.664.8918."))))}}]),t}(n.Component),A=a(206),R=a.n(A),D=a(513),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClickOpen=function(){a._isMounted&&a.setState({open:!0})},a.handleClose=function(){a._isMounted&&a.setState({open:!1})},a.handleKeyPress=function(e){"Enter"===e.key&&document.getElementById("submitButton").click()},a.handleSubmit=function(){var e=Object(j.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,b.auth().signInWithEmailAndPassword(document.getElementById("email").value,document.getElementById("password").value);case 4:n=e.sent,console.log(n),n&&(a.handleClose(),a.props.history.push("/main/clip")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),a._isMounted=!1,a.state={open:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){return r.a.createElement(E.q,{item:!0},r.a.createElement(E.b,{color:"secondary",variant:"outlined",onClick:this.handleClickOpen},"Login"),r.a.createElement(E.j,{open:this.state.open,onClose:this.handleClose,maxWidth:"xs",fullWidth:!0},r.a.createElement(E.m,null,"Login"),r.a.createElement(E.l,null,r.a.createElement(E.q,{container:!0,direction:"column",spacing:16},r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Email"),r.a.createElement(E.u,{id:"email",onKeyPress:this.handleKeyPress}))),r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Password"),r.a.createElement(E.u,{id:"password",type:"password",onKeyPress:this.handleKeyPress}))))),r.a.createElement(E.k,null,r.a.createElement(E.b,{id:"submitButton",onClick:this.handleSubmit},"Submit"))))}}]),t}(n.Component),U=Object(D.a)(H),q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClickOpenForm=function(){a.setState({openForm:!0})},a.handleCloseForm=function(){a.setState({openForm:!1,agreePolicy:!1})},a.handleAgreePolicy=function(e){a.setState({agreePolicy:e.target.checked}),e.target.checked&&a.setState({policyError:!1})},a.handleClickOpenPolicy=function(){a.setState({openPolicy:!0})},a.handleClosePolicy=function(){a.setState({openPolicy:!1})},a.handleKeyPress=function(e){"Enter"===e.key&&document.getElementById("submitButton").click()},a.validateForm=function(){var e=document.getElementById("username").value,t=document.getElementById("email").value,n=document.getElementById("password").value,r=document.getElementById("password2").value;return/^(([^<>()\]\\.,;:\s@"]+(\.[^<>()\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)?a.setState({emailError:!1}):a.setState({emailError:!0}),n.length<6?a.setState({passwordError:!0}):a.setState({passwordError:!1}),n!==r?a.setState({password2Error:!0}):a.setState({password2Error:!1}),""===e?a.setState({usernameError:!0}):a.setState({usernameError:!1}),a.state.agreePolicy||a.setState({policyError:!0}),{email:t,password:n,username:e}},a.handleSubmit=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,r,o,c,i,s,l;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.history,t.preventDefault(),e.next=4,a.validateForm();case 4:if(r=e.sent,o=r.email,c=r.password,i=r.username,s=b.firestore(),a.state.policyError||a.state.emailError||a.state.passwordError||a.state.password2Error||a.state.usernameError){e.next=21;break}return e.prev=10,e.next=13,b.auth().createUserWithEmailAndPassword(o,c);case 13:l=e.sent,console.log(l),l&&(s.collection("users").doc(b.auth().currentUser.uid).set({username:i,score:0}),a.handleCloseForm(),n.push("/main/clip")),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(10),alert(e.t0);case 21:case"end":return e.stop()}}),e,null,[[10,18]])})));return function(t){return e.apply(this,arguments)}}(),a.state={openForm:!1,agreePolicy:!1,openPolicy:!1,policyError:!1,emailError:!1,passwordError:!1,password2Error:!1,usernameError:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(E.q,{item:!0},r.a.createElement(E.b,{color:"secondary",variant:"outlined",onClick:this.handleClickOpenForm},"Register"),r.a.createElement(E.j,{open:this.state.openForm,onClose:this.handleCloseForm,maxWidth:"xs",fullWidth:!0},r.a.createElement(E.m,null,"Register"),r.a.createElement(E.l,null,r.a.createElement(E.q,{container:!0,direction:"column",justify:"space-evenly",alignItems:"stretch"},r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Username"),r.a.createElement(E.u,{id:"username",type:"text",onKeyPress:this.handleKeyPress})),this.state.usernameError?r.a.createElement(E.p,{error:!0},"Must Enter Your Username."):""),r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Email"),r.a.createElement(E.u,{id:"email",type:"email",onKeyPress:this.handleKeyPress})),this.state.emailError?r.a.createElement(E.p,{error:!0},"Invalid email."):""),r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Password"),r.a.createElement(E.u,{id:"password",type:"password",onKeyPress:this.handleKeyPress})),this.state.passwordError?r.a.createElement(E.p,{error:!0},"Password should be more than 6 characters."):""),r.a.createElement(E.q,{item:!0},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,null,"Reenter password"),r.a.createElement(E.u,{id:"password2",type:"password",onKeyPress:this.handleKeyPress})),this.state.password2Error?r.a.createElement(E.p,{error:!0},"Passwords didn't match."):""),r.a.createElement(E.q,{item:!0},r.a.createElement(E.o,{control:r.a.createElement(E.g,{checked:this.state.agreePolicy,onChange:this.handleAgreePolicy}),label:r.a.createElement("p",null,"I accept the\xa0",r.a.createElement(E.x,{component:"button",onClick:this.handleClickOpenPolicy,style:{fontSize:"1em"}},"Privacy Policy"))}),this.state.policyError?r.a.createElement(E.p,{error:!0},"You have to accept the privacy policy."):"",r.a.createElement(E.j,{open:this.state.openPolicy,onClose:this.handleClosePolicy,maxWidth:!1},r.a.createElement(E.l,{className:"privacy-in-dialog"},r.a.createElement(M,null)))))),r.a.createElement(E.k,null,r.a.createElement(E.b,{id:"submitButton",onClick:this.handleSubmit},"Submit"))))}}]),t}(n.Component),F=Object(D.a)(q),B=a(209),L=a.n(B),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleToggle=function(){a.setState((function(e){return{open:!e.open}}))},a.handleClose=function(e){a.setState({open:!1})},a.state={open:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.open;return r.a.createElement("div",null,r.a.createElement(E.t,{buttonRef:function(t){e.anchorEl=t},"aria-owns":t?"account-menu":void 0,"aria-haspopup":"true",onClick:this.handleToggle,color:"inherit"},r.a.createElement(L.a,null)),r.a.createElement(E.B,{open:t,anchorEl:this.anchorEl,placement:"bottom-end",transition:!0,disablePortal:!0},(function(t){var a=t.TransitionProps;return r.a.createElement(E.r,a,r.a.createElement(E.A,null,r.a.createElement(E.i,{onClickAway:e.handleClose},r.a.createElement(E.z,null,r.a.createElement(E.y,{onClick:e.handleClose},r.a.createElement(O.a,{to:"/main",style:{color:"black"}},"Summary")),r.a.createElement(E.y,{onClick:e.handleClose},"Change password"),r.a.createElement(E.y,{onClick:function(){e.props.logout(),e.handleClose()}},"Logout")))))})))}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).logout=function(){a.userDocListener&&a.userDocListener(),b.auth().signOut().then((function(){a.props.toggleAuth(!1)})).catch((function(e){console.log(e)})),a.props.history.push("/Major--Miner"),a.setState({score:0})},a.state={open:!1,score:null},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.db=b.firestore(),this.user=b.auth().currentUser,this.user&&this.db.collection("users").doc(this.user.uid).get().then((function(t){e.setState({score:t.data().score})}))}},{key:"componentWillUnmount",value:function(){this.userDocListener&&this.userDocListener()}},{key:"render",value:function(){return r.a.createElement(E.a,{position:"sticky",style:{borderBottom:"4px solid white"}},r.a.createElement(E.J,null,r.a.createElement("div",{className:"nav-container"},r.a.createElement(E.c,{component:O.a,to:"/Major--Miner",className:"nav-item"},r.a.createElement("img",{src:R.a,height:40,alt:"Logo"})),r.a.createElement(E.c,{component:O.a,to:"/Major--Miner",className:"nav-item"},"Home"),r.a.createElement(E.c,{component:O.a,to:"/info/about",className:"nav-item"},"About"),r.a.createElement(E.c,{component:O.a,to:"/info/faq",className:"nav-item"},"FAQ"),r.a.createElement(E.c,{component:O.a,to:"/info/contact",className:"nav-item"},"Contact Us"),this.props.authenticated?r.a.createElement(E.c,{component:O.a,to:"/main/clip",className:"nav-item"},"Game"):"",this.props.authenticated?r.a.createElement(E.c,{component:O.a,to:"/info/leaders",className:"nav-item"},"High Scores"):"",this.props.authenticated?r.a.createElement(E.c,{component:O.a,to:"/search",className:"nav-item"},"Search"):"",this.props.authenticated?r.a.createElement("div",{className:"account-button"},r.a.createElement("h4",{style:{margin:"0 0.5em",padding:"0 0.5em","font-weight":"400"}},"Score: ",this.state.score),r.a.createElement(W,{logout:this.logout})):r.a.createElement("div",{className:"account-button"},r.a.createElement(U,null),"\xa0 \xa0",r.a.createElement(F,null)))))}}]),t}(n.Component),z=Object(D.a)(_),K=a(130),Y=a(213),V=a.n(Y),G=a(212),J=a.n(G),$=a(211),Z=a.n($),Q=a(214),X=a.n(Q),ee=a(97),te=a(69),ae=a.n(te),ne=a(68),re=a.n(ne),oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).canvas=r.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.draw()}},{key:"draw",value:function(){var e=this.props.audioData,t=this.canvas.current,a=t.height,n=t.width,r=t.getContext("2d"),o=0,c=1*n/e.length;r.lineWidth=1,r.strokeStyle="#000000",r.clearRect(0,0,n,a),r.beginPath(),r.moveTo(0,a/2);var i=!0,s=!1,l=void 0;try{for(var u,d=e[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var m=u.value/255*a;r.lineTo(o,m),o+=c}}catch(p){s=!0,l=p}finally{try{i||null==d.return||d.return()}finally{if(s)throw l}}r.lineTo(o,a/2),r.stroke()}},{key:"render",value:function(){return r.a.createElement("canvas",{width:"300",height:"300",ref:this.canvas,className:"audio-canvas"})}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setupAudioContext=function(){a.audioContext=new(window.AudioContext||window.webkitAudioContext),a.gainNode=a.audioContext.createGain(),a.gainNode.gain.value=15,a.gainNode.connect(a.audioContext.destination),a.audioSource=a.audioContext.createMediaElementSource(a.audio),a.audioSource.connect(a.gainNode),a.analyser=a.audioContext.createAnalyser(),a.gainNode.connect(a.analyser),a.dataArray=new Uint8Array(a.analyser.frequencyBinCount),a.rafId=requestAnimationFrame(a.tick),a.audio.onended=function(){a._isMounted&&a.setState({play:!1})}},a.toggleAudio=function(){if(0===a.firstPlay)try{a.setupAudioContext(),console.log("props!",a.props.clipId);var e=Date.now();a.db.collection("Randomize").doc(a.props.clipId).set({count:f.a.firestore.FieldValue.increment(1),updated:f.a.firestore.FieldValue.serverTimestamp(),millis:e,userId:f.a.firestore.FieldValue.arrayUnion(a.currentId)},{merge:!0})}catch(t){console.log(t)}a.state.play?a.audio.pause():a.playAuto(a.audio),a._isMounted&&a.setState({play:!a.state.play}),a.firstPlay++},a._isMounted=!1,a.state={audioData:new Uint8Array(0),play:!1,url:""},a.tick=a.tick.bind(Object(ee.a)(a)),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.user=b.auth().currentUser,this.db=b.firestore(),this.currentId=b.auth().currentUser.uid,this.firstPlay=0,this.audio=new Audio(this.props.url),this.audio.crossOrigin="anonymous",window.screen.height>420&&window.screen.width>380&&this.toggleAudio()}},{key:"tick",value:function(){this.analyser.getByteTimeDomainData(this.dataArray),this._isMounted&&this.setState({audioData:this.dataArray}),this.rafId=requestAnimationFrame(this.tick)}},{key:"playAuto",value:function(e){this.audioContext.resume().then((function(){e.play()}))}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rafId),this.analyser.disconnect(),this.gainNode.disconnect(),this.audioSource.disconnect(),this._isMounted=!1}},{key:"render",value:function(){return r.a.createElement(E.q,{item:!0,sm:6,md:6,lg:6,className:"canvas-container"},r.a.createElement(E.t,{className:"play-button",onClick:this.toggleAudio,disableRipple:!0,disableTouchRipple:!0},this.state.play?r.a.createElement(re.a,{style:{fontSize:"180px"}}):r.a.createElement(ae.a,{style:{fontSize:"180px"}})),this.state.play?r.a.createElement(oe,{audioData:this.state.audioData}):r.a.createElement("canvas",{width:"300",height:"300",className:"audio-canvas"}))}}]),t}(n.Component),ie=a(29),se=a.n(ie),le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleExample=function(){a.setState({showExample:!a.state.showExample})},a.handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1,showExample:!1})},a.state={open:!1,showExample:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(E.b,{onClick:this.handleClickOpen,style:{color:"white"}},"Rules"),r.a.createElement(E.j,{open:this.state.open,onClose:this.handleClose},r.a.createElement(E.m,null,"Game Rules"),r.a.createElement(E.l,null,r.a.createElement("ul",{className:"rule-list"},r.a.createElement("li",null,"You will be presented with one randomly selected 10-second sound clip at a time."),r.a.createElement("li",null,'Describe that clip with a word or phrase (we call them "tags", here are some\xa0',r.a.createElement(E.c,{onClick:this.toggleExample,style:{fontSize:"0.9em",textDecoration:"underline"}},"examples"),") and ",r.a.createElement("b",null,"press enter"),"."),this.state.showExample?r.a.createElement("div",{className:"example-tags-list"},r.a.createElement("ul",null,r.a.createElement("li",null,"Animals \u2013 bird, songbird, sparrow, white-crowned sparrow, gambel's white crowned sparrow"),r.a.createElement("li",null,"Human-generated sounds \u2013 airplane, helicopter, drilling, engine, rumbling"),r.a.createElement("li",null,"Weather \u2013 wind, rain, thunder, gale, drizzle, dripping, stream, river"),r.a.createElement("li",null,"Scenes \u2013 quiet night, dawn chorus"),r.a.createElement("li",null,"Time \u2013 summer, winter, june, august afternoon, night, dawn"),r.a.createElement("li",null,"Feelings \u2013 calm, busy, soothing, loud, cacophonous"))):"",r.a.createElement("li",null,"If you're the first person to describe that clip with that tag, you'll get ",r.a.createElement("b",null,"2 points")," when the next person tags that clip with that tag."),r.a.createElement("li",null,"If you're the second person to describe that clip with that tag, you'll get ",r.a.createElement("i",null,"1 point")," immediately."),r.a.createElement("li",null,"If more than two people have already tagged that clip with that tag, you ",r.a.createElement("b",null,"won't get any points"),", but you can try another tag."),r.a.createElement("li",null,'Tag each clip as many times as you want, follow one of the "next clip" links to listen to a new one.'))),r.a.createElement("p",{style:{margin:"0em 2em 2em"}},'You can come back to see the rules by clicking "rules" at the top-left corner.')))}}]),t}(n.Component);function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function de(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(a,!0).forEach((function(t){Object(K.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var me={currentTags:{},displayTag:{},loading:!0,clipHistory:{},scoredClipHistory:{}},pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=Object(j.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.user=b.auth().currentUser,a.db=b.firestore(),a.currentId=b.auth().currentUser.uid,a.userId=a.user.uid,a.userRef=a.db.collection("users").doc(a.currentId),a.audioRef=a.db.collection("audios"),a.firstUserId="",a.loadUrl();case 8:case"end":return e.stop()}}),e)}))),a.Summary=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u,d,m,p,h,y,g,f,b,v,E,w,j,O,S,C,I,N,T,P,M,A,R,D,H,U,q,F,B,L,W,_,z,K,Y,V,G,J,$,Z,Q,X,ee,te;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.next=4,a.userRef.collection("clipHistory").orderBy("lastUpdatedAt").limit(10).get();case 4:r=e.sent,o={},c=!0,i=!1,s=void 0,e.prev=9,l=r.docs[Symbol.iterator]();case 11:if(c=(u=l.next()).done){e.next=55;break}return d=u.value,o[d.id]={score:d.data().score},m=a.db.collection("audios").doc(d.id).get(),t=[],n=[],p=a.db.collection("audios").doc(d.id).collection("users").doc(a.userId).get(),h=a.db.collection("audios").doc(d.id).collection("tags").get(),e.next=21,Promise.all([m,p,h]);case 21:for(y=e.sent,g=Object(x.a)(y,3),f=g[0],b=g[1],v=g[2],o[d.id].title=f.data().Title,o[d.id].url=f.data().Url,o[d.id].id=d.id,t=b.data().tags,o[d.id].TAG=t.join(", "),E=!0,w=!1,j=void 0,e.prev=34,O=v.docs[Symbol.iterator]();!(E=(S=O.next()).done);E=!0)C=S.value,t.includes(C.id)||n.push(C.id);e.next=42;break;case 38:e.prev=38,e.t0=e.catch(34),w=!0,j=e.t0;case 42:e.prev=42,e.prev=43,E||null==O.return||O.return();case 45:if(e.prev=45,!w){e.next=48;break}throw j;case 48:return e.finish(45);case 49:return e.finish(42);case 50:o[d.id].other=n.join(", "),a.setState({clipHistory:o});case 52:c=!0,e.next=11;break;case 55:e.next=61;break;case 57:e.prev=57,e.t1=e.catch(9),i=!0,s=e.t1;case 61:e.prev=61,e.prev=62,c||null==l.return||l.return();case 64:if(e.prev=64,!i){e.next=67;break}throw s;case 67:return e.finish(64);case 68:return e.finish(61);case 69:return e.next=71,a.userRef.collection("clipHistory").where("score",">",0).orderBy("score").limit(10).get();case 71:I=e.sent,N={},T=!0,P=!1,M=void 0,e.prev=76,A=I.docs[Symbol.iterator]();case 78:if(T=(R=A.next()).done){e.next=140;break}return D=R.value,N[D.id]={score:D.data().score},H=a.db.collection("audios").doc(D.id).get(),U=a.db.collection("audios").doc(D.id).collection("tags").where("userId","array-contains",a.userId).get(),q=a.db.collection("audios").doc(D.id).collection("tags").get(),e.next=86,Promise.all([H,U,q]);case 86:for(F=e.sent,B=Object(x.a)(F,3),L=B[0],W=B[1],_=B[2],N[D.id].title=L.data().Title,N[D.id].url=L.data().Url,N[D.id].id=D.id,t=[],n=[],z=!0,K=!1,Y=void 0,e.prev=99,V=W.docs[Symbol.iterator]();!(z=(G=V.next()).done);z=!0)J=G.value,t.push(J.id);e.next=107;break;case 103:e.prev=103,e.t2=e.catch(99),K=!0,Y=e.t2;case 107:e.prev=107,e.prev=108,z||null==V.return||V.return();case 110:if(e.prev=110,!K){e.next=113;break}throw Y;case 113:return e.finish(110);case 114:return e.finish(107);case 115:for(N[D.id].TAG=t.join(", "),$=!0,Z=!1,Q=void 0,e.prev=119,X=_.docs[Symbol.iterator]();!($=(ee=X.next()).done);$=!0)te=ee.value,t.includes(te.id)||n.push(te.id);e.next=127;break;case 123:e.prev=123,e.t3=e.catch(119),Z=!0,Q=e.t3;case 127:e.prev=127,e.prev=128,$||null==X.return||X.return();case 130:if(e.prev=130,!Z){e.next=133;break}throw Q;case 133:return e.finish(130);case 134:return e.finish(127);case 135:N[D.id].other=n.join(", "),a.setState({scoredClipHistory:N});case 137:T=!0,e.next=78;break;case 140:e.next=146;break;case 142:e.prev=142,e.t4=e.catch(76),P=!0,M=e.t4;case 146:e.prev=146,e.prev=147,T||null==A.return||A.return();case 149:if(e.prev=149,!P){e.next=152;break}throw M;case 152:return e.finish(149);case 153:return e.finish(146);case 154:a.props.history.push({pathname:"/main",state:{clipHistory:a.state.clipHistory,scoredClipHistory:a.state.scoredClipHistory}});case 155:case"end":return e.stop()}}),e,null,[[9,57,61,69],[34,38,42,50],[43,,45,49],[62,,64,68],[76,142,146,154],[99,103,107,115],[108,,110,114],[119,123,127,135],[128,,130,134],[147,,149,153]])}))),a.handleKeyPress=function(e){"Enter"===e.key&&document.getElementById("submitButton").click()},a.loadFiles=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new XMLHttpRequest,c=[],e.next=4,a.db.collection("audios");case 4:return i=e.sent,e.next=7,a.db.collection("Randomize");case 7:s=e.sent,n.onreadystatechange=Object(j.a)(k.a.mark((function e(){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200===n.status&&4===n.readyState)for(t=n.responseText,console.log(typeof t),r=JSON.parse(t),o=r.items,a=0;a<o.length;a++)i.doc(a+"").set({Title:o[a].name,Url:"https://firebasestorage.googleapis.com/v0/b/majorminer-dd13a.appspot.com/o/"+o[a].name+"?alt=media&token="+o[a].metadata.firebaseStorageDownloadTokens}),s.doc(a+"").set({count:0});case 1:case"end":return e.stop()}}),e)}))),n.open("GET","/text/data.json",!0),n.send(),console.log(c.length);case 12:case"end":return e.stop()}}),e)}))),a.loadUrl=Object(j.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("currentUser: "+b.auth().currentUser.uid),a.existingTags={},e.next=4,a.randomizeId();case 4:return a.clipId=e.sent,console.log(a.clipId),e.next=8,a.db.collection("audios").doc(a.clipId);case 8:return a.audioRef=e.sent,e.prev=9,e.next=12,a.audioRef.get();case 12:t=e.sent,a.url=t.data().Url,console.log(a.clipId),console.log(a.url),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(9),console.log(e.t0);case 21:return e.next=23,a.setState({loading:!1});case 23:case"end":return e.stop()}}),e,null,[[9,18]])}))),a.loadExistingTag=function(e){try{e&&e.forEach((function(e){return a.existingTags[e.id]={count:e.data().count}}))}catch(t){console.log("loadExistingTagError: "+t)}return a.existingTags},a.compareTime=function(){var e=Object(j.a)(k.a.mark((function e(t){var a,n,r,o,c,i,s,l,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=[])[0]="January",a[1]="February",a[2]="March",a[3]="April",a[4]="May",a[5]="June",a[6]="July",a[7]="August",a[8]="September",a[9]="October",a[10]="November",a[11]="December",n=t.toMillis(),r=new Date,o=r.getDate()+"",c=a[r.getMonth()]+" ",i=r.getFullYear()+"",s=c+o+", "+i,l=Date.parse(s),u=Date.now(),!(u-n<=36e5)){e.next=26;break}return e.abrupt("return",1);case 26:if(!(n<=l+864e5)){e.next=30;break}return e.abrupt("return",2);case 30:if(!(n<=l+6048e5)){e.next=34;break}return e.abrupt("return",3);case 34:return e.abrupt("return",4);case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.oneDayRange=function(){var e=[];e[0]="January",e[1]="February",e[2]="March",e[3]="April",e[4]="May",e[5]="June",e[6]="July",e[7]="August",e[8]="September",e[9]="October",e[10]="November",e[11]="December";var t=new Date,a=t.getDate()+"",n=e[t.getMonth()]+" "+a+", "+(t.getFullYear()+"");return Date.parse(n)+864e5},a.randomizeId=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u,d,m;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Set,r=Math.random(),e.next=4,a.db.collection("Randomize").where("userId","array-contains",a.currentId).get();case 4:for(o=e.sent,c=!0,i=!1,s=void 0,e.prev=8,l=o.docs[Symbol.iterator]();!(c=(u=l.next()).done);c=!0)d=u.value,n.add(d.id);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),i=!0,s=e.t0;case 16:e.prev=16,e.prev=17,c||null==l.return||l.return();case 19:if(e.prev=19,!i){e.next=22;break}throw s;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return m=a.findMin(.0066*o.size,.33),console.log("rand",r),console.log("pnew",m),r<m?(t=a.pick_pioneer(),console.log("rand < pnew")):(t=a.pick_settler(n),console.log("rand > pnew")),e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,null,[[8,12,16,24],[17,,19,23]])}))),a.pick_pioneer=Object(j.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.collection("Randomize").where("count","==",0).get();case 2:if(0===(t=e.sent).size){e.next=6;break}return console.log("noSeenSnapshot[0]"),e.abrupt("return",t.docs[0].id+"");case 6:return console.log("Math.random"),e.abrupt("return",Math.floor(5*Math.random())+"");case 8:case"end":return e.stop()}}),e)}))),a.pick_settler=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,r,o,c,i,s,l,u,d,m,p,h,y,g,f;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),r=n-36e5,e.next=4,a.db.collection("Randomize").where("millis","<",r).orderBy("millis").get();case 4:if(0!==(o=e.sent).size){e.next=10;break}return console.log("oneHourNoSeenSnapshot == 0"),e.abrupt("return",a.pick_pioneer());case 10:for(console.log("oneHourNoSeenSnapshot:  ",o),c=!0,i=!1,s=void 0,e.prev=14,l=o.docs[Symbol.iterator]();!(c=(u=l.next()).done);c=!0)d=u.value,console.log("oneHourNoSeenSnapshot",d.id);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),i=!0,s=e.t0;case 22:e.prev=22,e.prev=23,c||null==l.return||l.return();case 25:if(e.prev=25,!i){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:m=!0,p=!1,h=void 0,e.prev=33,y=o.docs[Symbol.iterator]();case 35:if(m=(g=y.next()).done){e.next=43;break}if(f=g.value,t.has(f.id)){e.next=40;break}return console.log("!userHasSeen.has(clip.id)"),e.abrupt("return",f.id+"");case 40:m=!0,e.next=35;break;case 43:e.next=49;break;case 45:e.prev=45,e.t1=e.catch(33),p=!0,h=e.t1;case 49:e.prev=49,e.prev=50,m||null==y.return||y.return();case 52:if(e.prev=52,!p){e.next=55;break}throw h;case 55:return e.finish(52);case 56:return e.finish(49);case 57:return e.abrupt("return",a.pick_pioneer());case 58:case"end":return e.stop()}}),e,null,[[14,18,22,30],[23,,25,29],[33,45,49,57],[50,,52,56]])})));return function(t){return e.apply(this,arguments)}}(),a.findMin=function(e,t){return e>t?t:e},a.getNextClip=Object(j.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({currentTags:{},loading:!0,displayTag:{}});case 2:a.loadUrl();case 3:case"end":return e.stop()}}),e)}))),a.handleSubmit=Object(j.a)(k.a.mark((function e(){var t,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("tags").value.toLowerCase().replace(/\s/g,"").split(","),n={},e.next=4,a.audioRef.collection("tags");case 4:return a.audioTagRef=e.sent,e.next=7,a.audioRef.collection("users");case 7:return a.audioUsersRef=e.sent,e.next=10,a.audioTagRef.get();case 10:return r=e.sent,e.next=13,a.loadExistingTag(r);case 13:a.existingTags=e.sent,console.log("existingTags"),console.log(a.existingTags),t.forEach((function(e){Object.keys(a.existingTags).includes(e)?n[e]={count:a.existingTags[e].count,score:0}:n[e]={count:0,score:0}})),console.log("displayTag"),console.log(a.state.displayTag),document.getElementById("tags").value="",a.loadTagsToDb(n).then((function(e){a.setState({currentTags:e});for(var t=function(){var t=r[n];a.setState((function(a){return{displayTag:de({},a.displayTag,Object(K.a)({},t,{score:e[t].score,count:e[t].count}))}}))},n=0,r=Object.keys(e);n<r.length;n++)t()}));case 21:case"end":return e.stop()}}),e)}))),a.getUserId=function(){var e=Object(j.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.collection("audios").doc(a.clipId).collection("users").where("tags","array-contains",t).get();case 2:return n=e.sent,console.log("firstUser:  ",n.docs[0].id),e.abrupt("return",n.docs[0].id);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadTagsToDb=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,r,o,c,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=0,r=Object.keys(t);case 2:if(!(n<r.length)){e.next=24;break}return o=r[n],e.next=6,a.addUser(o);case 6:if(a.History(a.userRef,a.currentId,0),1!==t[o].count){e.next=18;break}return e.next=10,a.getUserId(o);case 10:return c=e.sent,e.next=13,a.db.collection("users").doc(c);case 13:i=e.sent,console.log("!!firstUserId: "+c),c!==a.currentId&&(a.History(i,c,2),t[o].score=1,a.History(a.userRef,a.currentId,1)),e.next=19;break;case 18:t[o].count,a.History(a.userRef,a.currentId,0);case 19:return e.next=21,a.audioUsersRef.doc(a.currentId).set({tags:se.a.firestore.FieldValue.arrayUnion(o)},{merge:!0});case 21:n++,e.next=2;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.log("can't upload tags into DB!!:  "+e.t0);case 29:return e.abrupt("return",t);case 30:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(t){return e.apply(this,arguments)}}(),a.addUser=function(e){try{a.audioTagRef.doc(e).set({count:se.a.firestore.FieldValue.increment(1),userId:se.a.firestore.FieldValue.arrayUnion(a.currentId)},{merge:!0})}catch(t){console.log("can't add user: "+t)}},a.refreshTotalScore=function(e,t){e.update({score:se.a.firestore.FieldValue.increment(t)})},a.isFrist=function(e){a.audioTagRef.doc(e).set({count:1,userId:se.a.firestore.FieldValue.arrayUnion(a.currentId)})},a.History=function(){var e=Object(j.a)(k.a.mark((function e(t,n,r){var o,c,i,s,l,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.collection("clipHistory");case 3:(o=e.sent).doc(a.clipId).get().then((function(e){e.exists?a.updateHistory(o,r):a.createHistory(o,r),a.refreshTotalScore(t,r)})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Can't create clipHistory!! "+e.t0);case 10:if(0===r){e.next=28;break}return c=a.oneDayRange(),e.prev=12,i=a.db.collection("scoreRecord").doc(n),e.next=16,a.db.collection("scoreRecord").doc(n).collection("score");case 16:return(s=e.sent).doc(c+"").get().then((function(e){e.exists?s.doc(c+"").update({score:se.a.firestore.FieldValue.increment(r)}):s.doc(c+"").set({score:r,millis:c,createdAt:se.a.firestore.FieldValue.serverTimestamp()})})),e.next=20,a.db.collection("users").doc(n).get();case 20:l=e.sent,u=l.data().username,i.set({updated:se.a.firestore.FieldValue.serverTimestamp(),millis:c,username:u}),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(12),console.log("Can't add score scoreRecord!");case 28:case"end":return e.stop()}}),e,null,[[0,7],[12,25]])})));return function(t,a,n){return e.apply(this,arguments)}}(),a.updateHistory=function(e,t){try{e.doc(a.clipId).update({score:se.a.firestore.FieldValue.increment(t),lastUpdatedAt:se.a.firestore.FieldValue.serverTimestamp()})}catch(n){console.log("Can't update clipHistory: "+n)}},a.createHistory=function(e,t){try{e.doc(a.clipId).set({score:se.a.firestore.FieldValue.increment(t),createdAt:se.a.firestore.FieldValue.serverTimestamp(),lastUpdatedAt:se.a.firestore.FieldValue.serverTimestamp()})}catch(n){console.log("Can't create clipHistory: "+n)}},a.state=de({},me),a.textInput=r.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.textInput.current.focus()}},{key:"render",value:function(){var e=this.url,t=this.clipId,a=this.state.displayTag;return r.a.createElement("div",{className:"game-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy",style:{color:"white"}},"Privacy Policy")),r.a.createElement("h1",{className:"page-title"},"Describe this clip"),r.a.createElement(E.q,{container:!0,className:"game-container",direction:"column",alignItems:"center",spacing:16},r.a.createElement(E.q,{item:!0,container:!0,alignItems:"center"},r.a.createElement(E.q,{item:!0,sm:12,md:12,lg:12},r.a.createElement(le,null)),r.a.createElement(E.q,{item:!0,sm:10,md:10,lg:10}),r.a.createElement(E.q,{item:!0,sm:1,md:1,lg:1})),r.a.createElement(E.q,{item:!0,container:!0,alignItems:"center"},r.a.createElement(E.q,{item:!0,sm:3,md:3,lg:3},r.a.createElement(E.t,{id:"gameSummary",className:"game-menu",style:{borderRadius:"0",color:"white"}},r.a.createElement(O.a,{to:"/main"},r.a.createElement(Z.a,null),"Summary"))),this.state.loading?r.a.createElement(E.q,{item:!0,sm:6,md:6,lg:6,className:"canvas-container"},r.a.createElement(E.h,{size:100,thickness:3.6})):r.a.createElement(ce,{url:e,clipId:t}),r.a.createElement(E.q,{item:!0,sm:3,md:3,lg:3},r.a.createElement(E.t,{id:"nextClip",className:"game-menu",style:{borderRadius:"0",color:"white"},onClick:this.getNextClip},"Next Clip",r.a.createElement(J.a,null)))),r.a.createElement(E.q,{item:!0,id:"listTag",sm:10,md:6,lg:8},Object.keys(a).map((function(e,t){return 0===a[e].count?r.a.createElement("span",{key:t,className:"gray"},e,"\xa0"):1===a[e].score?r.a.createElement("i",{key:t,className:"1-point"},e,"\xa0"):r.a.createElement("span",{key:t,className:"pink"},e,"\xa0")}))),r.a.createElement(E.q,{item:!0,sm:10,md:6,lg:8,style:{color:"white"}},r.a.createElement(E.n,{margin:"normal",fullWidth:!0},r.a.createElement(E.w,{style:{borderRadius:"0",color:"white"}},">Input your tags..."),r.a.createElement(E.u,{style:{color:"white"},id:"tags",type:"text",autoFocus:!0,inputRef:this.textInput,onKeyPress:this.handleKeyPress,endAdornment:r.a.createElement(E.v,{position:"end",style:{color:"white"}},r.a.createElement(E.t,{id:"submitButton",onClick:this.handleSubmit,style:{color:"white"}},r.a.createElement(V.a,null)),r.a.createElement(E.K,{title:r.a.createElement("p",null,"You can input more than one tag ",r.a.createElement("br",null),"by using commas to separate."),placement:"right"},r.a.createElement(E.s,null,r.a.createElement(X.a,null))))}),r.a.createElement("div",{className:"game-contentbox"},r.a.createElement(E.p,{style:{color:"black"}},"Tag Colors: ",r.a.createElement("b",null,"2 points"),", ",r.a.createElement("i",null,"1 point"),", ",r.a.createElement("span",{className:"gray"}," no points yet (but could be 2)"),", ",r.a.createElement("span",{className:"pink"},"0 points"),"."))))))}}]),t}(n.Component),he=a(216),ye=a.n(he),ge=a(215),fe=a.n(ge),be=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setupAudioContext=function(){try{a.audioContext=new(window.AudioContext||window.webkitAudioContext),a.gainNode=a.audioContext.createGain(),a.gainNode.gain.value=15,a.gainNode.connect(a.audioContext.destination)}catch(e){console.log(e)}a.audio=new Audio(a.props.url),a.audioSource=a.audioContext.createMediaElementSource(a.audio),a.audio.crossOrigin="anonymous",a.audioSource.connect(a.gainNode),a.audioContext.resume().then((function(){console.log("Playback resumed successfully")})),a.audio.onended=function(){a.setState({play:!1}),a.props.togglePlay(!1)}},a.toggleAudio=function(){if(!1===a.state.play)try{a.setupAudioContext()}catch(e){console.log(e)}a.state.play?a.audio.pause():a.audio.play(),a.setState({play:!a.state.play}),a.props.togglePlay(!a.state.play)},a.toggleSeeOtherTags=function(){a.setState({seeOthers:!a.state.seeOthers})},a.SummaryAudioCard=function(){return r.a.createElement(E.d,{className:"audio-card"},r.a.createElement(E.f,null,r.a.createElement("h5",null,a.props.clip),r.a.createElement("p",null,"Your tags: ",a.props.TAG||"loading"),a.state.seeOthers?r.a.createElement("p",null,"Other's tags: ",a.props.other||"None"," "):""),r.a.createElement(E.e,{style:{paddingTop:"0"}},r.a.createElement(E.t,{onClick:a.toggleAudio},a.state.play?r.a.createElement(re.a,null):r.a.createElement(ae.a,null)),r.a.createElement(E.t,{onClick:a.toggleSeeOtherTags},a.state.seeOthers?r.a.createElement(fe.a,null):r.a.createElement(ye.a,null))))},a.SearchResultAudioCard=function(){return r.a.createElement(E.d,{className:"audio-card"},r.a.createElement(E.f,null,r.a.createElement("h5",null,a.props.clip)),r.a.createElement(E.e,{style:{paddingTop:"0"}},r.a.createElement(E.t,{onClick:a.toggleAudio},a.state.play?r.a.createElement(re.a,null):r.a.createElement(ae.a,null))),r.a.createElement("h5",null,a.props.tag,": ",a.props.count," times"))},a.state={play:!1,seeOthers:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.setupAudioContext()}},{key:"componentWillUnmount",value:function(){this.gainNode.disconnect(),this.audioSource.disconnect()}},{key:"render",value:function(){return r.a.createElement("div",null,this.props.fromSummary?this.SummaryAudioCard():this.SearchResultAudioCard())}}]),t}(n.Component),ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).togglePlay=function(e){a.setState({play:e})},a.state={clipHistory:{},scoredClipHistory:{},play:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(j.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.user=b.auth().currentUser,this.db=b.firestore(),this.audioRef=this.db.collection("audios"),this.userId=this.user.uid,this.userRef=this.db.collection("users").doc(this.userId);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.clipHistory,n=t.scoredClipHistory;return r.a.createElement("div",{className:"summary-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy"},"Privacy Policy")),r.a.createElement("h1",{className:"page-title"},"Summary"),r.a.createElement(O.a,{to:"/main/clip"},"Play Game!")," ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(O.a,{to:"/info/Leaders"},"High Scores"),r.a.createElement(E.q,{container:!0,className:"summary-container",direction:"column",alignItems:"center"},r.a.createElement("h2",{style:{"font-weight":"400"}},"Your last 10 clips"),r.a.createElement(E.q,{item:!0,className:"card-list-container"},r.a.createElement(E.q,{container:!0,className:"card-list",spacing:8},Object.keys(a).map((function(t,n){return r.a.createElement(E.q,{item:!0,key:t},r.a.createElement(be,{url:a[t].url,clip:a[t].title,clipId:a[t].id,TAG:a[t].TAG,togglePlay:e.togglePlay,other:a[t].other,fromSummary:!0}))})))),r.a.createElement("h2",{style:{"font-weight":"400"}},"Your last scored clips"),r.a.createElement(E.q,{item:!0,className:"card-list-container"},r.a.createElement(E.q,{container:!0,className:"card-list",spacing:8},Object.keys(n).map((function(t,a){return r.a.createElement(E.q,{item:!0,key:a},r.a.createElement(be,{url:n[t].url,clip:n[t].title,TAG:n[t].TAG,clipId:n[t].id,other:n[t].other,togglePlay:e.togglePlay,fromSummary:!0}))}))))))}}]),t}(n.Component),Ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).month=function(){var e=[];return e[0]="January",e[1]="February",e[2]="March",e[3]="April",e[4]="May",e[5]="June",e[6]="July",e[7]="August",e[8]="September",e[9]="October",e[10]="November",e[11]="December",e},a.handleChange=function(e,t){a.setState({value:t})},a.oneDayRange=function(){var e=a.month(),t=new Date,n=t.getDate()+"",r=e[t.getMonth()]+" "+n+", "+(t.getFullYear()+""),o=Date.parse(r);return console.log("today: ",o),o+864e5},a.firstOfWeekRange=function(){var e=a.month(),t=new Date,n=t.getDay(),r=t.getDate()+"",o=e[t.getMonth()]+" "+r+", "+(t.getFullYear()+""),c=Date.parse(o);return console.log("first day of the week",n),c-36e5*(n-1)*24},a.getTotal=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,a.db.collection("users").where("score",">",0).get();case 3:for(n=e.sent,r=!0,o=!1,c=void 0,e.prev=7,i=n.docs[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)l=s.value,u={username:l.data().username,score:l.data().score,userId:l.id},t.push(u);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,c=e.t0;case 15:e.prev=15,e.prev=16,r||null==i.return||i.return();case 18:if(e.prev=18,!o){e.next=21;break}throw c;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return t.sort((function(e,t){return t.score-e.score})),t.splice(10,t.length),e.next=27,a.setState({totalLeader:t});case 27:console.log(a.state.totalLeader);case 28:case"end":return e.stop()}}),e,null,[[7,11,15,23],[16,,18,22]])}))),a.getToday=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u,d,m;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=a.oneDayRange(),e.next=4,a.db.collection("scoreRecord").where("millis","==",n).get();case 4:r=e.sent,o=!0,c=!1,i=void 0,e.prev=8,s=r.docs[Symbol.iterator]();case 10:if(o=(l=s.next()).done){e.next=20;break}return u=l.value,e.next=14,a.db.collection("scoreRecord").doc(u.id).collection("score").where("millis","==",n).get();case 14:d=e.sent,m={username:u.data().username,score:d.docs[0].data().score,userId:u.id},t.push(m);case 17:o=!0,e.next=10;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(8),c=!0,i=e.t0;case 26:e.prev=26,e.prev=27,o||null==s.return||s.return();case 29:if(e.prev=29,!c){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return t.sort((function(e,t){return t.score-e.score})),t.splice(10,t.length),e.next=38,a.setState({todayLeader:t});case 38:console.log("today: ",new Date(n)),console.log("today!!!leader: ",t);case 40:case"end":return e.stop()}}),e,null,[[8,22,26,34],[27,,29,33]])}))),a.getWeek=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l,u,d,m,p,h,y,g,f,b,v;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=a.firstOfWeekRange(),console.log("thisWeekRange:  ",n),console.log("Sunday",new Date(n)),e.next=6,a.db.collection("scoreRecord").where("millis",">=",n).get();case 6:r=e.sent,o=!0,c=!1,i=void 0,e.prev=10,s=r.docs[Symbol.iterator]();case 12:if(o=(l=s.next()).done){e.next=42;break}return u=l.value,d=0,e.next=17,a.db.collection("scoreRecord").doc(u.id).collection("score").where("millis",">=",n).get();case 17:for(m=e.sent,p=!0,h=!1,y=void 0,e.prev=21,g=m.docs[Symbol.iterator]();!(p=(f=g.next()).done);p=!0)b=f.value,d+=b.data().score;e.next=29;break;case 25:e.prev=25,e.t0=e.catch(21),h=!0,y=e.t0;case 29:e.prev=29,e.prev=30,p||null==g.return||g.return();case 32:if(e.prev=32,!h){e.next=35;break}throw y;case 35:return e.finish(32);case 36:return e.finish(29);case 37:v={username:u.data().username,score:d,userId:u.id},t.push(v);case 39:o=!0,e.next=12;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e.catch(10),c=!0,i=e.t1;case 48:e.prev=48,e.prev=49,o||null==s.return||s.return();case 51:if(e.prev=51,!c){e.next=54;break}throw i;case 54:return e.finish(51);case 55:return e.finish(48);case 56:return t.sort((function(e,t){return t.score-e.score})),t.splice(10,t.length),e.next=60,a.setState({weekLeader:t});case 60:console.log("weekLeader: ",t);case 61:case"end":return e.stop()}}),e,null,[[10,44,48,56],[21,25,29,37],[30,,32,36],[49,,51,55]])}))),a.getTabContent=function(e,t,n){var o;switch(a.state.value){case 0:o=e;break;case 1:o=t;break;case 2:o=n;break;default:o=[]}return r.a.createElement(E.D,{className:"leaderboard"},r.a.createElement(E.G,null,r.a.createElement(E.H,null,r.a.createElement(E.F,{align:"center",style:{color:"white"}},"User"),r.a.createElement(E.F,{align:"center",style:{color:"white"}},"Score"))),r.a.createElement(E.E,null,o.map((function(e,t){return r.a.createElement(E.H,{key:e.userId},r.a.createElement(E.F,{align:"center"},e.username),r.a.createElement(E.F,{align:"center"},e.score))}))))},a.state={value:0,todayLeader:[],weekLeader:[],totalLeader:[]},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.user=b.auth().currentUser,this.db=b.firestore(),this.user&&(this.currentId=b.auth().currentUser.uid),this.getTotal(),this.getToday(),this.getWeek()}},{key:"render",value:function(){var e=this.state,t=e.todayLeader,a=e.weekLeader,n=e.totalLeader;return r.a.createElement("div",{className:"leaders-page"},r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy",style:{color:"white"}},"Privacy Policy")),r.a.createElement("div",null,r.a.createElement("h1",{className:"page-title"},"High Scores"),r.a.createElement("div",{className:"table-container"},r.a.createElement(E.a,{position:"static"},r.a.createElement(E.I,{value:this.state.value,onChange:this.handleChange,centered:!0},r.a.createElement(E.C,{label:"Today"}),r.a.createElement(E.C,{label:"This week"}),r.a.createElement(E.C,{label:"Total"}))),this.getTabContent(t,a,n))))}}]),t}(n.Component),we=a(67),ke=a.n(we),xe=a(66),je=a.n(xe),Oe=a(96),Se=a.n(Oe),Ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getTagList=Object(j.a)(k.a.mark((function e(){var t,n,r,o,c,i,s,l;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,a.db.collection("tagList").orderBy("count","desc").limit(10).get();case 3:for(n=e.sent,r=!0,o=!1,c=void 0,e.prev=7,i=n.docs[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)l=s.value,t.push({tag:l.id,count:l.data().count});e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,c=e.t0;case 15:e.prev=15,e.prev=16,r||null==i.return||i.return();case 18:if(e.prev=18,!o){e.next=21;break}throw c;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,null,[[7,11,15,23],[16,,18,22]])}))),a.handleKeyPress=function(e){"Enter"===e.key&&document.getElementById("searchButton").click()},a.handleSubmit=function(){var e=document.getElementById("searchItem").value;a.handleListClick(null,e)},a.handleListClick=function(){var e=Object(j.a)(k.a.mark((function e(t,n){var r,o,c,i,s,l,u,d,m,p,h,y,g,f,b,v;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.collection("tagList").doc(n).collection("clipIDs").get();case 2:return r=e.sent,e.next=5,a.db.collection("tagList").doc(n).collection("clipIDs").orderBy("count","desc").get();case 5:for(o=e.sent,c=[],i=!0,s=!1,l=void 0,e.prev=10,u=o.docs[Symbol.iterator]();!(i=(d=u.next()).done);i=!0)m=d.value,c.push({tag:m.id,count:m.data().count});e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,l=e.t0;case 18:e.prev=18,e.prev=19,i||null==u.return||u.return();case 21:if(e.prev=21,!s){e.next=24;break}throw l;case 24:return e.finish(21);case 25:return e.finish(18);case 26:a.MyTagMap={},p=!0,h=!1,y=void 0,e.prev=30,g=r.docs[Symbol.iterator]();case 32:if(p=(f=g.next()).done){e.next=44;break}return b=f.value,a.MyTagMap[b.id]={},e.next=37,a.db.collection("tagList").doc(n).collection("clipIDs").doc(b.id).get();case 37:v=e.sent,a.MyTagMap[b.id].url=v.data().Url,a.MyTagMap[b.id].clip=v.data().Title,a.MyTagMap[b.id].count=v.data().count;case 41:p=!0,e.next=32;break;case 44:e.next=50;break;case 46:e.prev=46,e.t1=e.catch(30),h=!0,y=e.t1;case 50:e.prev=50,e.prev=51,p||null==g.return||g.return();case 53:if(e.prev=53,!h){e.next=56;break}throw y;case 56:return e.finish(53);case 57:return e.finish(50);case 58:a.props.history.push({pathname:"/seachresult",state:{tag:n,MyTag:a.MyTagMap,tagOrderArray:c,clipNumber:r.size}});case 59:case"end":return e.stop()}}),e,null,[[10,14,18,26],[19,,21,25],[30,46,50,58],[51,,53,57]])})));return function(t,a){return e.apply(this,arguments)}}(),a.getList=function(e){return r.a.createElement(ke.a,null,e.map((function(e,t){return r.a.createElement(je.a,{button:!0,key:e.tag},r.a.createElement(Se.a,{primary:e.tag,onClick:function(t){return a.handleListClick(t,e.tag)}}))})))},a.state={topTags:[]},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(j.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.user=b.auth().currentUser,this.db=b.firestore(),this.currentId=b.auth().currentUser.uid,this.userRef=this.db.collection("users"),e.t0=this,e.next=7,this.getTagList();case 7:e.t1=e.sent,e.t2={topTags:e.t1},e.t0.setState.call(e.t0,e.t2);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.topTags;return r.a.createElement("div",{className:"search-page"},r.a.createElement(E.q,{container:!0,className:"search-container",direction:"column",alignItems:"center"},r.a.createElement(E.q,{item:!0},r.a.createElement("h1",{className:"page-title"},"Search"),r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"./info/privacy",style:{color:"white"}},"Privacy Policy"))),r.a.createElement(E.q,{item:!0},r.a.createElement("label",null,"Search by tag: "),r.a.createElement("input",{id:"searchItem",type:"text",onKeyPress:this.handleKeyPress}),r.a.createElement(E.b,{id:"searchButton",onClick:this.handleSubmit},"search")),r.a.createElement(E.q,{item:!0,xs:12,md:6},r.a.createElement("div",null,this.getList(e)))))}}]),t}(n.Component),Ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).togglePlay=function(e){a.setState({play:e})},a.state={play:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(j.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.user=b.auth().currentUser,this.db=b.firestore(),this.audioRef=this.db.collection("audios"),this.userId=this.user.uid,this.userRef=this.db.collection("users").doc(this.userId);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state,a=t.MyTag,n=t.tag,o=t.clipNumber,c=t.tagOrderArray;return r.a.createElement("div",{className:"search-page"},r.a.createElement(E.q,{container:!0,className:"summary-container",direction:"column",alignItems:"center"},r.a.createElement(E.q,{item:!0},r.a.createElement("h1",{className:"page-title"},"Search Results"),r.a.createElement("div",{className:"privacy-corner"},r.a.createElement(O.a,{to:"/info/privacy",style:{color:"white"}},"Privacy Policy"))),r.a.createElement(E.q,{item:!0},r.a.createElement(O.a,{to:"/search"},"Search more!")),r.a.createElement(E.q,{item:!0},r.a.createElement(O.a,{to:"/main/clip"},"Play Game!")),r.a.createElement("h2",null,"Here are ",o," clip have been describe as ",n),r.a.createElement(E.q,{item:!0,className:"card-list-container"},r.a.createElement(E.q,{container:!0,className:"card-list",spacing:8},c.map((function(t,o){return r.a.createElement(E.q,{item:!0,key:t.tag},r.a.createElement(be,{tag:n,clip:a[t.tag].clip,url:a[t.tag].url,count:a[t.tag].count,togglePlay:e.togglePlay,fromSummary:!1}))}))))))}}]),t}(n.Component),Ne=Object(v.createMuiTheme)({palette:{primary:{main:"#224440"},secondary:{main:"#ffffff"}},typography:{useNextVariants:!0},overrides:{MuiInput:{underline:{"&:before":{borderBottom:"1px solid white"},"&:hover":{borderBottom:"1px solid white"},"&:after":{borderBottom:"1px solid white"},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid white !important"}}}}});function Te(e){var t=e.component,a=e.authenticated,n=Object(m.a)(e,["component","authenticated"]);return r.a.createElement(p.a,Object.assign({},n,{render:function(e){return!0===a?r.a.createElement(t,Object.assign({},e,n)):r.a.createElement(h.a,{to:"/Major--Miner"})}}))}var Pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleAuth=function(e){a.setState({authenticated:e})},a.state={authenticated:!1,user:null,loading:!0},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.listener=b.auth().onAuthStateChanged((function(t){t?e.setState({authenticated:!0,user:t,loading:!1}):e.setState({authenticated:!1,user:null,loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){var e=this;return this.state.loading?r.a.createElement(v.MuiThemeProvider,{theme:Ne},r.a.createElement("div",{className:"loading-container"},r.a.createElement(E.h,{size:100,thickness:3.6}))):r.a.createElement(v.MuiThemeProvider,{theme:Ne},r.a.createElement(y.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(z,{authenticated:this.state.authenticated,toggleAuth:this.toggleAuth}),r.a.createElement("main",null,r.a.createElement(p.a,{exact:!0,path:"/Major--Miner",render:function(t){return r.a.createElement(S,Object.assign({},t,{authenticated:e.state.authenticated}))}}),r.a.createElement(p.a,{path:"/info/faq",component:N}),r.a.createElement(p.a,{path:"/info/contact",component:P}),r.a.createElement(p.a,{path:"/info/about",component:T}),r.a.createElement(p.a,{path:"/info/privacy",component:M}),r.a.createElement(p.a,{path:"/info/leaders",component:Ee}),r.a.createElement(p.a,{path:"/seachresult",component:Ie}),r.a.createElement(Te,{exact:!0,path:"/main",component:ve,authenticated:this.state.authenticated}),r.a.createElement(Te,{exact:!0,path:"/main/clip",component:pe,authenticated:this.state.authenticated}),r.a.createElement(Te,{path:"/search",component:Ce,authenticated:this.state.authenticated})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[275,1,2]]]);
//# sourceMappingURL=main.a078cd12.chunk.js.map